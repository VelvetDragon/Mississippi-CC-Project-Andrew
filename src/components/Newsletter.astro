---
---
<div class="newsletter-signup">
  <div class="newsletter-content">
    <h3>Subscribe to Culinary Tales</h3>
    <p>Get the latest stories, recipes, and updates from the Mississippi Community Cookbook Project delivered to your inbox.</p>
    
    <form action="https://gmail.us20.list-manage.com/subscribe/post?u=89d95b1506296222cdb651ffd&id=cb0a80759d&f_id=0095cdedf0" method="post" id="newsletter-form" class="signup-form">
      <input type="email" name="EMAIL" id="mce-EMAIL" placeholder="Your email address" required />
      
      <!-- Real people should not fill this in and expect good things - do not remove this or risk form bot signups -->
      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_89d95b1506296222cdb651ffd_cb0a80759d" tabindex="-1" value="">
      </div>

      <button type="submit" id="subscribe-btn">Subscribe</button>
    </form>
    
    <div id="form-message" class="form-message"></div>
    
    <p class="spam-notice">We respect your privacy. No spam, ever.</p>
  </div>
</div>

<script>
  const form = document.getElementById('newsletter-form');
  const messageDiv = document.getElementById('form-message');
  const submitBtn = document.getElementById('subscribe-btn');

  if (form) {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // UI: Disable button and show loading state
      submitBtn.disabled = true;
      submitBtn.textContent = 'Subscribing...';
      messageDiv.style.display = 'none';
      messageDiv.className = 'form-message'; // Reset classes

      // 1. Get the URL and convert it to JSONP format
      // Change '/post?' to '/post-json?'
      let url = form.getAttribute('action').replace('/post?', '/post-json?');
      
      // 2. Add form data
      const formData = new FormData(form);
      const params = new URLSearchParams();
      for (const pair of formData.entries()) {
        params.append(pair[0], pair[1]);
      }
      
      // 3. Add the callback parameter for JSONP
      url += '&' + params.toString() + '&c=onMailchimpResponse';

      // 4. Create the JSONP script
      const script = document.createElement('script');
      script.src = url;
      
      // 5. Define the global callback function
      window.onMailchimpResponse = function(response) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Subscribe';
        messageDiv.style.display = 'block';

        if (response.result === 'success') {
          // Success!
          messageDiv.textContent = 'Thank you for subscribing!';
          messageDiv.classList.add('success');
          form.reset();
        } else {
          // Error (e.g. already subscribed, invalid email)
          // Mailchimp errors often contain "0 - " at the start, let's clean it
          let msg = response.msg || 'Something went wrong. Please try again.';
          if (msg.includes('0 - ')) { msg = msg.replace('0 - ', ''); }
          messageDiv.textContent = msg;
          messageDiv.classList.add('error');
        }

        // Clean up script tag
        document.body.removeChild(script);
        delete window.onMailchimpResponse;
      };

      // Inject the script to trigger the request
      document.body.appendChild(script);
    });
  }
</script>

<style>
  .form-message {
    display: none;
    margin-top: 1rem;
    padding: 0.8rem 1.2rem;
    border-radius: 12px;
    font-size: 0.95rem;
    font-weight: 500;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  
  .form-message.success {
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.15) 0%, rgba(76, 175, 80, 0.08) 100%);
    color: #2e7d32;
    border: 1px solid rgba(76, 175, 80, 0.3);
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
  }

  .form-message.error {
    background: linear-gradient(135deg, rgba(211, 47, 47, 0.15) 0%, rgba(211, 47, 47, 0.08) 100%);
    color: #c62828;
    border: 1px solid rgba(211, 47, 47, 0.3);
    box-shadow: 0 4px 15px rgba(211, 47, 47, 0.1);
  }

  .newsletter-signup {
    /* Glassy Orange Effect */
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.7) 0%,
      rgba(255, 255, 255, 0.4) 30%,
      rgba(200, 118, 61, 0.08) 70%,
      rgba(200, 118, 61, 0.15) 100%
    );
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    padding: 3rem 2rem;
    border-radius: 24px;
    border: 1px solid rgba(255, 255, 255, 0.5);
    margin: 4rem 0;
    text-align: center;
    box-shadow: 
      0 8px 32px rgba(200, 118, 61, 0.12),
      0 2px 8px rgba(0, 0, 0, 0.06),
      inset 0 1px 0 rgba(255, 255, 255, 0.8),
      inset 0 -1px 0 rgba(200, 118, 61, 0.1);
    position: relative;
    overflow: hidden;
  }

  /* Shiny highlight effect */
  .newsletter-signup::before {
    content: '';
    position: absolute;
    top: 0;
    left: -50%;
    width: 200%;
    height: 50%;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.4) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      transparent 100%
    );
    pointer-events: none;
    border-radius: 24px 24px 100% 100%;
  }

  .newsletter-content {
    max-width: 600px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  h3 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 1rem;
    text-shadow: 0 2px 4px rgba(200, 118, 61, 0.1);
  }

  p {
    color: var(--text-muted);
    margin-bottom: 2rem;
    font-size: 1.1rem;
  }

  .signup-form {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  input[type="email"] {
    flex: 1;
    padding: 1rem 1.25rem;
    border: 1px solid rgba(200, 118, 61, 0.2);
    border-radius: 14px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.9) 0%,
      rgba(255, 255, 255, 0.7) 100%
    );
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 
      inset 0 1px 2px rgba(0, 0, 0, 0.05),
      0 2px 8px rgba(0, 0, 0, 0.04);
  }

  input[type="email"]:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 
      inset 0 1px 2px rgba(0, 0, 0, 0.05),
      0 0 0 3px rgba(200, 118, 61, 0.15),
      0 4px 12px rgba(200, 118, 61, 0.1);
  }

  input[type="email"]::placeholder {
    color: rgba(102, 102, 102, 0.7);
  }

  button {
    background: linear-gradient(
      135deg,
      var(--primary-color) 0%,
      var(--primary-dark) 100%
    );
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 14px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 
      0 4px 15px rgba(200, 118, 61, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    position: relative;
    overflow: hidden;
  }

  /* Button shine effect */
  button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.25) 0%,
      rgba(255, 255, 255, 0.05) 100%
    );
    border-radius: 14px 14px 100% 100%;
    pointer-events: none;
  }

  button:hover {
    background: linear-gradient(
      135deg,
      #d4885a 0%,
      var(--primary-dark) 100%
    );
    transform: translateY(-2px);
    box-shadow: 
      0 6px 20px rgba(200, 118, 61, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.25);
  }

  button:active {
    transform: translateY(0);
    box-shadow: 
      0 2px 10px rgba(200, 118, 61, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
    transform: none;
  }

  .spam-notice {
    font-size: 0.85rem;
    margin-bottom: 0;
    opacity: 0.7;
    color: var(--text-muted);
  }

  @media (max-width: 600px) {
    .newsletter-signup {
      padding: 2rem 1.5rem;
      border-radius: 20px;
    }

    h3 {
      font-size: 1.6rem;
    }

    p {
      font-size: 1rem;
    }

    .signup-form {
      flex-direction: column;
    }
    
    button {
      width: 100%;
    }

    input[type="email"] {
      padding: 0.9rem 1rem;
    }
  }
</style>